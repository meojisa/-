<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–∏—Ç–∞–ª–∫–∞ - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –£–ù–¶ –†–ê–ù</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <style>
        /* –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã –ø—Ä—è–º–æ –≤ HTML –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ */
        body.dark-theme {
            background-color: #2b2c25;
            color: #eae9e6;
        }
        body.dark-theme .reader-viewport {
            background-color: #3e3a37;
            border-color: #555;
        }
        body.dark-theme .book-details {
            background-color: rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-top">
                <a href="index.html" class="logo">
                    <img src="https://via.placeholder.com/50x50?text=–õ–æ–≥–æ" alt="–õ–æ–≥–æ—Ç–∏–ø –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏">
                    <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</span>
                </a>
                <nav class="main-nav">
                    <a href="index.html#catalog-section">–ö–∞—Ç–∞–ª–æ–≥</a>
                    <a href="index.html#contact-section">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                </nav>
                <div class="auth-buttons">
                    <button id="themeToggle" class="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
                    <button class="menu-toggle" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">‚ò∞</button> </div>
                </div>
            </div>
        </div>
    </header>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (–≥–∞–º–±—É—Ä–≥–µ—Ä) -->
    <nav class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-header">
            <button class="close-menu">&times;</button>
            <h3>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h3>
        </div>
        <ul>
            <li><a href="#profile-section" data-section="profile-tab"><i class="fas fa-user-edit"></i> –ü—Ä–æ—Ñ–∏–ª—å –∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä</a></li>
            <li><a href="#profile-section" data-section="favorites-tab"><i class="fas fa-star"></i> –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a></li>
            <li><a href="#profile-section" data-section="history-tab"><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è —á—Ç–µ–Ω–∏—è</a></li>
            <li><a href="#profile-section" data-section="notes-tab"><i class="fas fa-bookmark"></i> –ó–∞–∫–ª–∞–¥–∫–∏ –∏ –∑–∞–º–µ—Ç–∫–∏</a></li>
            <li><a href="#profile-section" data-section="settings-tab"><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
        </ul>
    </nav>


    <main class="main-content">
        <section class="reader-section container">
            <div class="book-actions-top">
                <button id="addBookmark" class="button primary">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–ª–∞–¥–∫—É</button>
                <button id="backToCatalog" class="button">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
            </div>

            <div class="book-meta">
                <div class="book-cover-large">
                    <img id="bookCover" src="" alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏" onerror="this.src='https://via.placeholder.com/200x300?text=–ù–µ—Ç+–æ–±–ª–æ–∂–∫–∏'">
                </div>
                <div class="book-details">
                    <h1 id="bookTitle">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
                    <p><strong>–ê–≤—Ç–æ—Ä:</strong> <span id="bookAuthor"> </span></p>
                    <p><strong>–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è:</strong> <span id="bookYear"> </span></p>
                    <p><strong>–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è:</strong> <span id="bookAnnotation"> </span></p>
                    <p><strong>–°—Ç—Ä–∞–Ω–∏—Ü:</strong> <span id="pageCount"> </span></p>

                    <button class="button secondary" id="toggleDetails">–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏</button>
                    <div id="bookDetails">
                    </div>
                </div>
            </div>

                <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∫–Ω–∏–≥–∏
        function loadBookDetails(book) {
            const detailsDiv = document.getElementById('bookDetails');
            
            const detailsHTML = `
                <div class="detail-item">
                    <span class="detail-label">–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä:</span>
                    <span class="detail-value">${book.order_number || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ó–∞–≥–ª–∞–≤–∏–µ:</span>
                    <span class="detail-value">${book.full_title || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ú–µ—Å—Ç–æ –∏–∑–¥–∞–Ω–∏—è:</span>
                    <span class="detail-value">${book.publication_place || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞:</span>
                    <span class="detail-value">${book.quantity_info || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</span>
                    <span class="detail-value">${book.notes || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–†–∞–∑–¥–µ–ª:</span>
                    <span class="detail-value">${book.section || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ò–Ω–¥–µ–∫—Å ISBN:</span>
                    <span class="detail-value">${book.isbn || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–®–∏—Ñ—Ä –£–î–ö/–ë–ë–ö:</span>
                    <span class="detail-value">${book.udc_bbk_code || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π –Ω–æ–º–µ—Ä:</span>
                    <span class="detail-value">${book.inventory_number || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è:</span>
                    <span class="detail-value">${book.storage_location || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–°–≤–µ–¥–µ–Ω–∏—è –æ –¥–æ–±–∞–≤–æ—á–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–∫–∞—Ö:</span>
                    <span class="detail-value">${book.additional_cards || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ü—Ä–∏–∂–∏–∑–Ω–µ–Ω–Ω–æ–µ –∏–∑–¥–∞–Ω–∏–µ:</span>
                    <span class="detail-value">${book.lifetime_edition ? '–î–∞' : '–ù–µ—Ç'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ê–≤—Ç–æ–≥—Ä–∞—Ñ—ã –∞–≤—Ç–æ—Ä–æ–≤:</span>
                    <span class="detail-value">${book.author_autographs || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ò–∑ –ª–∏—á–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π:</span>
                    <span class="detail-value">${book.from_personal_collections || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è:</span>
                    <span class="detail-value">${book.additional_info || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å:</span>
                    <span class="detail-value">${book.sender || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ê–¥—Ä–µ—Å–∞—Ç:</span>
                    <span class="detail-value">${book.addressee || '‚Äî'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ:</span>
                    <span class="detail-value">${book.scanned ? '–î–∞' : '–ù–µ—Ç'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–ü–µ—Ä–µ–ø–ª–µ—Ç:</span>
                    <span class="detail-value">${book.binding_type || '‚Äî'}</span>
                </div>
            `;
            
            detailsDiv.innerHTML = detailsHTML;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏"
        document.getElementById('toggleDetails').addEventListener('click', function() {
            const detailsDiv = document.getElementById('bookDetails');
            const isExpanded = detailsDiv.classList.contains('expanded');
            
            if (!isExpanded && detailsDiv.innerHTML === '') {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ—Ç–∞–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
                loadBookDetails(bookData);
            }
            
            detailsDiv.classList.toggle('expanded');
            this.textContent = isExpanded ? '–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏' : '–°–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏';
        });
    </script>
            
            <div class="reader-viewport">
                <canvas id="pdfCanvas"></canvas>
                <div id="pdfLoading" style="text-align: center; padding: 20px;">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥–∏...
                </div>
                <div id="pdfError" style="display: none; color: #ff4444; text-align: center; padding: 20px;"></div>
            </div>

            <div class="page-navigation">
                <button id="prevPage" class="button primary" disabled>–ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>
                <span class="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ <span id="currentPage">1</span> –∏–∑ <span id="totalPages">0</span></span>
                <button id="nextPage" class="button primary" disabled>–°–ª–µ–¥—É—é—â–∞—è</button>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <nav class="footer-nav">
                <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                <a href="#">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                <a href="#">FAQ</a>
            </nav>
            <p>&copy; 2025 –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –£–ù–¶ –†–ê–ù. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>
    
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–µ–Ω—é-–≥–∞–º–±—É—Ä–≥–µ—Ä–∞
    const menuToggle = document.querySelector('.menu-toggle');
    const sidebarMenu = document.getElementById('sidebarMenu');
    const closeMenu = document.querySelector('.close-menu');

    menuToggle.addEventListener('click', function() {
        sidebarMenu.classList.add('open');
        document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
    });

    closeMenu.addEventListener('click', function() {
        sidebarMenu.classList.remove('open');
        document.body.style.overflow = ''; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –º–µ–Ω—é
    document.addEventListener('click', function(e) {
        if (!sidebarMenu.contains(e.target) && !menuToggle.contains(e.target)) {
            sidebarMenu.classList.remove('open');
            document.body.style.overflow = '';
        }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –≤ –º–µ–Ω—é
    document.querySelectorAll('#sidebarMenu a').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const section = this.getAttribute('data-section');
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
            alert(`–ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª: ${section}`);
            sidebarMenu.classList.remove('open');
            document.body.style.overflow = '';
        });
    });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                body.classList.add('dark-theme');
                themeToggle.textContent = '‚òÄÔ∏è';
            }

            themeToggle.addEventListener('click', function() {
                const isDark = body.classList.toggle('dark-theme');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            });

            // –ö–Ω–æ–ø–∫–∞ "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥"
            document.getElementById('backToCatalog').addEventListener('click', function() {
                if (window.history.length > 1 && document.referrer.includes(window.location.hostname)) {
                    window.history.back();
                } else {
                    window.location.href = 'index.html';
                }
            });
        });
    </script>
    
    <script src="reader.js"></script>
</body>
</html>